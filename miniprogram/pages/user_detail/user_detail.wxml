<form class="weui-form"  bindsubmit="onUserSubmit">
    <view class="weui-form__title" style="text-align: center;">用户信息</view>
    <view class="weui-form__control-area">
        <button class="avatar-wrapper" open-type="chooseAvatar" bind:chooseavatar="onChooseAvatar">
            <image class="avatar" src="{{avatarUrl}}"></image>
        </button>
        <van-cell-group inset>
            <van-field model:value="{{nickname}}" type="nickname" size="large" label="昵称" error="{{addresses.errors.nickname}}" placeholder="请输入昵称" name="nickname" required clearable  />
            <van-field model:value="{{address}}" type="textarea" size="large" required readonly autosize is-link disable-default-padding label="联系方式" error="{{addresses.errors.address}}"  placeholder="请添加联系方式" bindtap="onAddrDialogShow" />
        </van-cell-group>
    </view>
    <view class="weui-form__text-area">
        <checkbox-group wx:if="{{isReg}}" bindchange="onAgree">
            <label class="weui-agree" for="weuiAgree">
                <view class="weui-agree__text {{addresses.errors.agree ? 'error-wrapper' : 'transparent-wrapper'}}">
                    <checkbox class="weui-agree__checkbox" id="weuiAgree" value="agree" checked="{{isAgree}}" />
                    <view class="weui-agree__checkbox-icon">
                        <icon class="weui-agree__checkbox-icon-check" type="success_no_circle" size="9" wx:if="{{isAgree}}"></icon>
                    </view>
                    我同意<navigator url="../agreement/aggrement" class="weui-agree__link"><b>用户服务协议及隐私政策</b></navigator>
                </view>
            </label>
        </checkbox-group>
    </view>
    <view class="weui-form__control-area">
        <button form-type="submit" type="primary" class="weui-btn">{{isReg ? '注册' : '更新'}}</button>
        <button type="default" class="weui-btn" bindtap="onUserCancel">取消</button>
    </view>
</form>

<van-popup show="{{addresses.show}}" round position="bottom" bind:close="onAddrDialogHide" custom-class="weui-half-screen-dialog">
    <view class="weui-half-screen-dialog__hd" style="padding-bottom: 0">
        <view class="weui-half-screen-dialog__hd__main">
            <view class="weui-half-screen-dialog__title">联系方式</view>
        </view>
    </view>
    <view class="weui-half-screen-dialog__bd" style="padding: 0 0 32px;">
        <view wx:if="{{addresses.lists.length == 0}}" style="display: flex; flex-direction: column;align-items: center; justify-content: center;">
            <image class="hint-image" mode="widthFix" src="/images/location.png"></image>
            <view class="hint-text">还没有联系方式</view>
        </view>
        <view class="list-wrapper">
            <scroll-view class="list" scroll-y>
                <van-swipe-cell right-width="{{120}}" wx:for="{{addresses.lists}}" wx:key="address" wx:for-item="address">
                    <van-cell-group>
                        <van-cell id="{{address._id}}" title="{{address.recipient}} {{address.telNumber}}" label="{{address.fullAddr}} {{address.postalCode}}" clickable bind:click="onAddrClick" center>
                            <van-icon slot="icon" name="success" class="{{ address.current ? 'selected-addr' : 'unselected-addr' }}" />
                        </van-cell>
                    </van-cell-group>
                    <view slot="right" class="slot">
                        <van-button id="{{address._id}}" type="primary" block square custom-class="slot-button" bind:click="onAddrChange">修改</van-button>
                        <van-button id="{{address._id}}" type="danger" block square custom-class="slot-button" bind:click="onAddrRemove">删除</van-button>
                    </view>
                </van-swipe-cell>
            </scroll-view>
        </view>
    </view>
    <view class="weui-half-screen-dialog__ft" style="padding: 0 24px 32px;">
        <button type="primary" class="weui-btn" bindtap="onAddrImport">微信导入</button>
        <button type="default" class="weui-btn" bindtap="onAddrManual">手动新增</button>
    </view>
</van-popup>

<van-popup show="{{editor.show}}" round position="bottom" bind:close="onEditorDialogHide" custom-class="weui-half-screen-dialog">
    <view class="weui-half-screen-dialog__hd" style="padding-bottom: 0">
        <view class="weui-half-screen-dialog__hd__main">
            <view class="weui-half-screen-dialog__title">地址编辑</view>
        </view>
    </view>
    <view class="weui-half-screen-dialog__bd" style="padding: 0 0 32px;">
        <form>
            <van-cell-group>
                <van-field model:value="{{inputEditorRecipient}}" error="{{editor.errors.recipient}}" type="text" size="large" required clearable label="收件人" placeholder="请输入姓名" />
                <van-field model:value="{{inputEditorTel}}" error="{{editor.errors.tel}}" type="number" size="large" required clearable label="手机号" placeholder="请输入收货手机号" />
                <van-field model:value="{{inputEditorAddr}}" error="{{editor.errors.addr}}" type="textarea" size="large" required clearable autosize disable-default-padding label="详细地址" placeholder="请输入规范地址" />
                <van-field model:value="{{inputEditorPos}}" error="{{editor.errors.pos}}" type="number" size="large" required clearable label="邮政编码" placeholder="请输入邮政编码" />
            </van-cell-group>
        </form>
    </view>
    <view class="weui-half-screen-dialog__ft" style="padding: 0 0 32px;">
        <button type="default" class="weui-btn" bindtap="onEditorDialogHide">取消</button>
        <button type="primary" class="weui-btn" bindtap="onEditorSubmit">确认</button>
    </view>
</van-popup>
